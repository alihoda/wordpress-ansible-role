#jinja2: trim_blocks: "true", lstrip_blocks: "true"
{{ ansible_managed | comment }}
# Generated by Ansible role {{ ansible_role_name }}

version: '3'

services:
  db:
    image: mysql:8.0
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: {{ wordpress_db_root_password }}
      MYSQL_DATABASE: {{ wordpress_db_name }}
      MYSQL_USER: {{ wordpress_db_user }}
      MYSQL_PASSWORD: {{ wordpress_db_password }}
    volumes:
      - db:/var/lib/mysql
    networks:
      - app
  
  wp:
    image: wordpress:6.4-fpm-alpine
    depends_on:
      - db
    environment:
      WORDPRESS_DB_HOST: db:5506
      WORDPRESS_DB_NAME: {{ wordpress_db_name }}
      WORDPRESS_DB_USER: {{ wordpress_db_user }}
      WORDPRESS_DB_PASSWORD: {{ wordpress_db_password }}
    volumes:
      - {{ wordpress_base_dir }}/html:/var/www/html
    networks:
      - app
      - web
    
networks:
  app:
  web:
    external: true

volumes:
  db:
